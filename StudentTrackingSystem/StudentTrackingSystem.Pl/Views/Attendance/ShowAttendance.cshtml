@model List<StudentTrackingSystem.Pl.DTOs.AttendanceDTO>
@using StudentTrackingSystem.DAL.Models

@{
    ViewData["Title"] = "Show Attendance";
    var highlightId = Context.Request.Query["highlight"].ToString();
}

<div class="container mt-4">
    <h2>Attendance Records</h2>

    <div class="row mb-4">
        <div class="col-md-4">
            <form method="get" class="form-inline">
                <div class="form-group">
                    <label class="mr-2">Filter by Grade:</label>
                    <select name="grade" class="form-control" onchange="this.form.submit()">
                        <option value="">All Grades</option>
                        @foreach (Grade grade in ViewBag.Grades)
                        {
                            if (Context.Request.Query["grade"] == grade.Name)
                            {
                                <option value="@grade.Name" selected>@grade.Name</option>
                            }
                            else
                            {
                                <option value="@grade.Name">@grade.Name</option>
                            }
                        }
                    </select>
                </div>
            </form>
        </div>
    </div>

    <div class="table-responsive">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Student Name</th>
                    <th>Grade</th>
                    <th>Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var attendance in Model)
                {
                    <tr class="@(attendance.Id.ToString() == highlightId ? "table-warning" : "")" id="attendance-@attendance.Id">
                        <td>@attendance.StudentName</td>
                        <td>@attendance.Grade</td>
                        <td>@attendance.Date.ToString("dd/MM/yyyy")</td>
                        <td>
                            <span class="badge @(attendance.IsPresent ? "bg-success" : "bg-danger")">
                                @(attendance.IsPresent ? "Present" : "Absent")
                            </span>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Get the highlighted attendance ID from URL
            const urlParams = new URLSearchParams(window.location.search);
            const highlightId = urlParams.get('highlight');
            
            if (highlightId) {
                // Scroll to the highlighted row
                const element = document.getElementById('attendance-' + highlightId);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        });
    </script>
} 